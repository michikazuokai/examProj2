# ğŸ“˜ è©¦é¨“ãƒ‡ãƒ¼ã‚¿å†ãƒ­ãƒ¼ãƒ‰ç”¨ ç®¡ç†ã‚³ãƒãƒ³ãƒ‰é‹ç”¨æ‰‹é †æ›¸



æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€è©¦é¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆSubject / Exam / Question / æ¡ç‚¹æƒ…å ±ï¼‰ã‚’

**å®‰å…¨ã«å†ãƒ­ãƒ¼ãƒ‰ãƒ»å†åˆæœŸåŒ–ã™ã‚‹ãŸã‚ã® Django ç®¡ç†ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œæ‰‹é †**ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

------



## **1ï¸âƒ£ å…¨ä½“ã®å®Ÿè¡Œé †ï¼ˆé‡è¦ï¼‰**



**å†ãƒ­ãƒ¼ãƒ‰ï¼ˆæ¡ç‚¹ãƒªã‚»ãƒƒãƒˆå«ã‚€ï¼‰ã‚’è¡Œã†å ´åˆã®æ¨å¥¨å®Ÿè¡Œé †**

```
â‘  clear_subject_data.py        ï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨å‰Šé™¤ï¼‰
â‘¡ load_subject_base.py         ï¼ˆSubject / Exam ä½œæˆï¼‰
â‘¢ load_questions.py            ï¼ˆJSON â†’ Question ç™»éŒ²ï¼‰
â‘£ load_student_exam_version.py ï¼ˆå­¦ç”Ÿ Ã— Exam ãƒãƒ¼ã‚¸ãƒ§ãƒ³å‰²å½“ï¼‰
â‘¤ load_student_exam.py         ï¼ˆStudentExam ä½œæˆï¼šTF=0, hosei=0ï¼‰
â‘¥ load_exam_adjust.py          ï¼ˆExamAdjust ä½œæˆï¼šadjust=0ï¼‰
```

- æ¡ç‚¹ã®ã¿ãƒªã‚»ãƒƒãƒˆã—ãŸã„å ´åˆã¯ **â‘ ã¯ä¸è¦**
- æ¡ç‚¹ãƒªã‚»ãƒƒãƒˆã®ã¿ã®å ´åˆã¯ **clear_subject_scores.py** ã‚’ä½¿ç”¨



------

## **2ï¸âƒ£ å„ã‚³ãƒãƒ³ãƒ‰ã®ä»•æ§˜**

------



## **ğŸ§¹ clear_subject_data.py**


### **ï¼ˆSubject é…ä¸‹ã®è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦å‰Šé™¤ï¼‰**




### **æ¦‚è¦**



æŒ‡å®šã—ãŸ subjectNo ã«ç´ã¥ã **Exam ä»¥ä¸‹ã®å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ CASCADE å‰Šé™¤**ã—ã¾ã™ã€‚

â€» Subject è‡ªä½“ã¯å‰Šé™¤ã—ã¾ã›ã‚“ã€‚


### **å‰Šé™¤å¯¾è±¡**


- Exam
- Question
- StudentExam
- StudentExamVersion
- ExamAdjust


### **å®Ÿè¡Œä¾‹**

```
python manage.py clear_subject_data 2022001
```

### **ã‚ªãƒ—ã‚·ãƒ§ãƒ³**

ãªã—

### **æ³¨æ„**

- **å…ƒã«æˆ»ã›ã¾ã›ã‚“**
- å†ãƒ­ãƒ¼ãƒ‰å‰æã®ã¨ãã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„

------

## **ğŸ§¹ clear_subject_scores.py**

### **ï¼ˆæ¡ç‚¹çµæœã®ã¿ã‚¼ãƒ­ã‚¯ãƒªã‚¢ãƒ»å®‰å…¨ç¢ºèªä»˜ãï¼‰**

### **æ¦‚è¦**

æŒ‡å®š subject ã® **æ¡ç‚¹çµæœã®ã¿** ã‚’ 0 ã«æˆ»ã—ã¾ã™ã€‚

| **ãƒ¢ãƒ‡ãƒ«**  | **å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰** |
| ----------- | ------------------ |
| StudentExam | TF, hosei          |
| ExamAdjust  | adjust             |

â€» ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“


### **å®Ÿè¡Œä¾‹**

```
python manage.py clear_subject_scores 2022001
```

### **å®Ÿè¡Œæ™‚ã®ç¢ºèª**

- Subject æƒ…å ±
- å¯¾è±¡ä»¶æ•°ã‚’è¡¨ç¤º
- y / yes å…¥åŠ›æ™‚ã®ã¿å®Ÿè¡Œ

------

## **ğŸ“˜ load_subject_base.py**

### **ï¼ˆSubject / Exam ä½œæˆï¼‰**


### **æ¦‚è¦**

JSON ãƒ‡ãƒ¼ã‚¿ã‚’å…ƒã«ä»¥ä¸‹ã‚’ä½œæˆã—ã¾ã™ã€‚

- Subjectï¼ˆå­˜åœ¨ã—ãªã‘ã‚Œã°æ–°è¦ä½œæˆï¼‰
- Examï¼ˆversion å˜ä½ï¼‰

### **ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿**

- answers_xxxxx.json
- questions[0] ã®ãƒ¡ã‚¿æƒ…å ±ã‚’ä½¿ç”¨


### **å®Ÿè¡Œä¾‹**

```
python manage.py load_subject_base 2022001
```

### **è£œè¶³**

- term ã¯ **settings.py ã® TERM** ã‚’ä½¿ç”¨
- fsyear ã¯ JSON ã®å€¤ã‚’ä½¿ç”¨

------

## **ğŸ“„ load_questions.py**

### **ï¼ˆJSON â†’ Question ç™»éŒ²ï¼‰**

### **æ¦‚è¦**

è§£ç­”ç”¨ JSON ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ **Question ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ**ã—ã¾ã™ã€‚

### **å¯¾å¿œé–¢ä¿‚ï¼ˆæŠœç²‹ï¼‰**

| **Question** | **JSON**            |
| ------------ | ------------------- |
| q_no         | label               |
| bunrui       | koumoku             |
| points       | point               |
| answer       | answer              |
| width        | width               |
| height       | height / baseHeight |
| gyo          | é…åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹    |
| retu         | é…åˆ—å†…ä½ç½®          |

### **å®Ÿè¡Œä¾‹**

```
python manage.py load_questions 2022001
```

------

## **ğŸ‘¥ load_student_exam_version.py**

### **ï¼ˆå­¦ç”Ÿ Ã— Exam ãƒãƒ¼ã‚¸ãƒ§ãƒ³å‰²å½“ï¼‰**

### **æ¦‚è¦**

YAML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ã€å­¦ç”Ÿã”ã¨ã® Exam ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆA/Bï¼‰ã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã€‚

### **å‡¦ç†å†…å®¹**

1. Subject â†’ nenji å–å¾—
2. entyear ã‚’è¨ˆç®—ï¼ˆentyear = fsyear - nenji + 1ï¼‰
3. å¯¾è±¡å­¦ç”Ÿã‚’å–å¾—
4. YAML ã‹ã‚‰å­¦ç”Ÿç•ªå·ãƒªã‚¹ãƒˆå–å¾—
5. StudentExamVersion ä½œæˆ

### **å®Ÿè¡Œä¾‹**

```
python manage.py load_student_exam_version 2022001
```
### **ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿**

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†… YAMLï¼ˆæœ¬ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ï¼‰

------

## **ğŸ“ load_student_exam.py**

### **ï¼ˆStudentExam ä½œæˆï¼šé«˜é€Ÿå‡¦ç†ï¼‰**

### **æ¦‚è¦**

StudentExamVersion ã‚’å…ƒã«ã€

**Student Ã— Exam Ã— Question** ã®å…¨çµ„ã¿åˆã‚ã›ã‚’ä½œæˆã—ã¾ã™ã€‚

### **åˆæœŸå€¤**

```
TF = 0
hosei = 0
```
### **ç‰¹å¾´**

- bulk_create() ä½¿ç”¨
- å¤§é‡ãƒ‡ãƒ¼ã‚¿ã§ã‚‚é«˜é€Ÿ

### **å®Ÿè¡Œä¾‹**

```
python manage.py load_student_exam 2022001
```

------

## **â• load_exam_adjust.py**

### **ï¼ˆExamAdjust ä½œæˆï¼‰**


### **æ¦‚è¦**

StudentExamVersion ã‚’å…ƒã«ã€

**å­¦ç”Ÿ Ã— Exam ã®è£œæ­£ãƒ¬ã‚³ãƒ¼ãƒ‰**ã‚’ä½œæˆã—ã¾ã™ã€‚

### **åˆæœŸå€¤**

```
adjust = 0
```

### **å®Ÿè¡Œä¾‹**

```
python manage.py load_exam_adjust 2022001
```

------

## **3ï¸âƒ£ é‹ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¥ã¾ã¨ã‚**

### **ğŸ” å®Œå…¨å†ãƒ­ãƒ¼ãƒ‰ï¼ˆå•é¡Œä¿®æ­£ãƒ»è©¦é¨“ä½œã‚Šç›´ã—ï¼‰**

```
clear_subject_data
â†’ load_subject_base
â†’ load_questions
â†’ load_student_exam_version
â†’ load_student_exam
â†’ load_exam_adjust
```

### **ğŸ”„ æ¡ç‚¹ã®ã¿ãƒªã‚»ãƒƒãƒˆ**

```
clear_subject_scores
```

------

## **4ï¸âƒ£ æ³¨æ„äº‹é …ï¼ˆé‡è¦ï¼‰**

- å†ãƒ­ãƒ¼ãƒ‰å‰ã«ã¯ **å¿…ãš subjectNo ã‚’ç¢ºèª**
- YAML ã«å­˜åœ¨ã—ãªã„å­¦ç”Ÿã¯å‰²ã‚Šå½“ã¦ã•ã‚Œã¾ã›ã‚“
- æœ¬æœŸã¯ term / fsyear ã®è¨­è¨ˆå¤‰æ›´ã¯è¡Œã£ã¦ã„ã¾ã›ã‚“ï¼ˆæ¥æœŸå¯¾å¿œï¼‰

